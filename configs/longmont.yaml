# Floor area approximately correct, but building model assumes no increase after 2035, while BAU assumes constant increase up to 2050. The former is used.
# Use updated building code and enforce
## excel residential electricity EUI change 0.164..0.103 kWh/ft**2 between 2023..2050. KP 0.336..1.49
## EUI electricity/natural gas for residential/commercial excel .. KP
## 2050
# 0.103 .. 1.49
# 0.583 .. 12.4
# 0.009 .. 0.123
# 0.020 .. 0.415
## 2030
# 0.14776 .. 0.639
# 1.32840 .. 6.39
# 0.01224 .. 0.053
# 0.04456 .. 0.214
# Conclusion: current approach is all over the place and needs to be fixed.
# Let's use absolute CF changes as forecast values for the action. THis requires than two datasets are used.
# How can this be done? With get_input_dataset_pl() with tags.
# Then, floor_area and improvement are in different units and different dimensions (latter has also metric electricity/natural gas)
# How to deal with that? Two metrics but then only one can be shown.
# Or two actions tied together? How to use subactions?
# Or just two actions? That will make three more actions. And the baseline trend action
# What about historical improvement? Those are ignored in excel also, only BAU used.

# Develop beyond building code percentage needs to be recalculated from the EUI before updated building code, so that together they give right amount of saving.

id: longmont
default_language: en
supported_languages: [es]
site_url: https://longmont.paths-test.kausal.tech
dataset_repo:
  url: https://github.com/kausaltech/dvctest.git
  commit: 5076b171445c7f568612718d354322b91031b86c
  dvc_remote: kausal-s3
name: Longmont Greenhouse Gas Inventory
owner_en: City of Longmont
theme_identifier: us-longmont
target_year: 2050
model_end_year: 2050
reference_year: 2016
minimum_historical_year: 2016
maximum_historical_year: 2021
emission_unit: t/a
emission_forecast_from: 2023
emission_dimensions: [emission_scope]
emission_dataset: longmont/greenhouse_gas_emissions_by_subsector
emission_sector_dimension: emission_sectors
normalizations:
- normalizer_node: population
  quantities:
  - id: emissions
    unit: t/cap/a
  - id: energy
    unit: kWh/cap/a
  - id: mileage
    unit: miles/cap/a
features:
  baseline_visible_in_graphs: true

action_groups:
- id: buildings
  name: Buildings
- id: transportation
  name: Transportation
- id: electric_grid
  name: Electric grid
- id: solid_waste
  name: Solid waste
- id: oil_and_gas
  name: Oil and gas
- id: trend
  name: Trends beyond own control

dimensions:
- id: emission_scope
  label: Emission scopes
  categories:
  - id: scope1
    label: Scope 1
    color: '#0f05a0'
    order: 0
  - id: scope2
    label: Scope 2
    color: '#30505e'
    order: 1
  - id: scope3
    label: Scope 3
    color: '#6496ff'
    order: 2
  - id: negative_emissions
    label: Negative emissions
    color: '#F7A5AF'
    order: -1

- id: emission_sectors
  label: Emission sectors
  categories:
  - id: stationary_energy
    label: Stationary energy
  - id: buildings
    label: Building energy
  - id: residential_energy
    label: Residential energy
  - id: commercial_industrial_energy
    label: Commercial and industrial energy
  - id: streetlights
    label: Streetlights
  - id: stationary_electricity
    label: Total electricity
  - id: stationary_natural_gas
    label: Total natural gas
  - id: stationary_diesel
    label: Total diesel
  - id: fugitive_emissions
    label: Fugitive emissions
  - id: leakage_from_natural_gas
    label: Leakage from natural gas
  - id: leakage_from_oil_and_gas_wells
    label: Total oil and gas wells
  - id: transmission_losses
    label: Transmission and distribution losses
  - id: transport
    label: Transportation
  - id: on_road_transportation
    label: Total on-road
  - id: aviation
    label: Aviation
  - id: railways
    label: Total railways
  - id: off_road
    label: Total off-road
  - id: waste
    label: Waste
  - id: waste_disposal
    label: Waste disposal
  - id: waste_water_treatment
    label: Waste water treatment
  - id: avoided_waste
    label: Total avoided emissions from recycling
  - id: ippu
    label: Industrial processes and product use
  - id: refridgerant
    label: Refridgerant emissions
  - id: afolu
    label: Agriculture, forestry, and other land use
  - id: food_consumption
    label: Food
  - id: textile_consumption
    label: Textiles
  - id: other_consumption
    label: Other consumption

- id: vehicle_type
  label: Vehicle type
  groups:
  - id: cars
    label: Cars
    id_match: ^car_.+
  - id: motorcycles
    label: Motorcycles
    id_match: ^motorbike_.+
  - id: buses
    label: Local buses
    id_match: ^buses_.+
  - id: trolleybuses
    label: Trolley buses
    id_match: ^trolley.*
  - id: coaches
    label: Coaches
    id_match: ^coach_.+
  - id: lorries
    label: Lorries
    id_match: ^lorry_.+
  - id: vans
    label: Vans
    id_match: ^van_.+
  - id: rail
    label: Rail transport
    id_match: ^(tram|small_railways|rail).*
  - id: maritime
    label: Maritime transport
    id_match: ^.*_ship_.*
  - id: mobility_outside_city
    label: Mobility ourside the city
    id_match: ^mobility_outside_city
  - id: aviation
    label: Aviation
    id_match: ^aviation

  categories:
  - id: motorcycle
    label: Motorcycle
  - id: car
    label: Passenger Car
  - id: light_duty
    label: Light Duty
  - id: bus
    label: Bus
  - id: single_unit_truck
    label: Single Unit Truck
  - id: combination_unit_truck
    label: Combination Unit Truck
  - id: car_petrol
    label: Passenger cars / Petrol
  - id: car_diesel
    label: Passenger cars / Diesel
  - id: car_natural_gas_biogas
    label: Passenger cars / Natural gas / biogas
  - id: car_ethanol
    label: Passenger cars / Ethanol
  - id: car_e85
    label: Passenger cars / E85
  - id: car_plugin_hybrid
    label: Passenger cars / Plug-in hybrid
  - id: car_batteryelectric
    label: Passenger cars / Battery-Electric
  - id: car_fuel_cell
    label: Passenger cars / Fuel cell
  - id: motorbike_petrol_4stroke
    label: Motorbikes / Petrol 4-stroke engine
  - id: motorbike_petrol_2stroke
    label: Motorbikes / Petrol 2-stroke engine
  - id: motorbike_batteryelectric
    label: Motorbikes / Battery-Electric
  - id: buses_diesel
    label: Regular buses / Diesel
  - id: buses_diesel_hybrid
    label: Regular buses / Diesel hybrid
  - id: buses_diesel_plugin_hybrid
    label: Regular buses / Diesel plug-in hybrid
  - id: buses_batteryelectric
    label: Regular buses / Battery-Electric
  - id: buses_fuel_cell
    label: Regular buses / Fuel cell
  - id: trolley
    label: Trolley buses
  - id: coach_diesel
    label: Coaches / Diesel
  - id: coach_natural_gas_biogas
    label: Coaches / Natural gas/Biogas
  - id: coach_battery_electric
    label: Coaches / Battery-Electric
  - id: coach_fuel_cell
    label: Coaches / Fuel cell
  - id: lorry_diesel
    label: Lorries / Diesel
  - id: lorry_natural_gas_biogas
    label: Lorries / Natural gas/Biogas
  - id: lorry_diesel_plugin_hybrid
    label: Lorries / Diesel plug-in hybrid
  - id: lorry_battery_electric
    label: Lorries / Battery-Electric
  - id: lorry_fuel_cell
    label: Lorries / Fuel cell
  - id: van_petrol
    label: Vans / Petrol
  - id: van_diesel
    label: Van / Diesel
  - id: van_natural_gas_biogas
    label: Van / Natural gas/Biogas
  - id: van_diesel_plugin_hybrid
    label: Van / Plug-in hybrid
  - id: van_battery_electric
    label: Van / Battery-Electric
  - id: van_fuel_cell
    label: Van / Fuel cell
  - id: tram
    label: Tram
  - id: small_railways
    label: Small railways
  - id: rail_passenger
    label: Rail (passenger transport)
  - id: rail_goods
    label: Rail (goods transport)
  - id: liner_ship_diesel
    label: Liner ship / Diesel
  - id: liner_ship_battery_electric
    label: Liner ship / Battery-Electric
  - id: private_ship_petrol
    label: Private ships / Petrol
  - id: private_ship_diesel
    label: Private ships / Diesel
  - id: private_ship_battery_electric
    label: Private ships / Battery-Electric
  - id: mobility_outside_city
    label: Mobility ourside the city (excl. aviation)
  - id: aviation
    label: Aviation

- id: greenhouse_gases
  label: Greenhouse gases
  categories:
  - id: co2_eq
    label: CO2 equivalent
  - id: co2
    label: CO2, fossil
    aliases: [co2_fossil]
  - id: ch4
    label: CH4
  - id: n2o
    label: N2O
  - id: hfc
    label: HFC
  - id: pfc
    label: PFC
  - id: sf6
    label: SF6
  - id: nf3
    label: NF3
  - id: co2_biogen
    label: CO2, biogen

- id: energy_carrier
  label: Energy carrier
  categories:
  - id: electricity
    label: Electricity
  - id: fuel_oil
    label: Heating oil
  - id: petrol
    label: Gasoline
    aliases: [Petrol]
  - id: diesel
    label: Diesel
  - id: ethanol
    label: Ethanol
  - id: plug_in_hybrid
    label: Plug-in hybrid EV
  - id: kerosene
    label: Jet fuel
  - id: aviation_gasoline
    label: Aviation gasoline
  - id: natural_gas
    label: Natural gas
  - id: biogas
    label: biogas
  - id: propane
    label: Propane
  - id: district_heat
    label: District heating
  - id: wood
    label: Wood
  - id: environmental_heat
    label: Environmental heat
  - id: solar_collectors
    label: Solar thermal collectors
  - id: waste
    label: Waste

- id: electricity_source
  label: Electricity source
  categories:
  - id: hydro
    label: Hydropower
  - id: nuclear
    label: Nuclear power
  - id: natural_gas
    label: Natural gas
  - id: solar
    label: Solar
  - id: biogas
    label: Biogas
  - id: waste
    label: Waste incineration
  - id: wind
    label: Wind
  - id: wood
    label: Wood
  - id: fuel_oil
    label: Heating oil
  - id: import
    label: European import
    aliases:
    - UCTE-Mix / ENTSO-E Mix
    - Nicht deklariert (UCTE)
    - Nicht deklariert (UCTE-Mix)
  - id: subsidized
    label: Subsidized electricity

- id: site
  label: Production or consumption site
  categories:
  - id: longmont_power
    label: Longmont Power
  - id: xcel_energy
    label: Xcel Energy
  - id: various
    label: Various
  - id: home
    label: Home

- id: waste
  label: Waste type
  categories:
  - id: landfilled
    label: Landfilled waste
  - id: composted
    label: Composted waste
  - id: recycled
    label: Recycled waste
  - id: wastewater
    label: Wastewater

- id: building_energy_class
  label: Building energy class
  categories:
  - id: all
    label: All buildings, baseline
  - id: regular
    label: Regular old buildings
  - id: renovated
    label: Renovated old buildings
  - id: compliant
    label: New code-compliant buildings
  - id: non_compliant
    label: New buildings not compliant with code
  - id: existing
    label: Existing building stock
  - id: new
    label: Building stock to be built

- id: action
  label: Actions affecting nodes
  categories:
  - id: none
    label: No actions taken
  - id: updated_building_code
    label: Use updated building code
  - id: updated_building_code_residential
    label: Use updated building code, residential
  - id: updated_building_code_commercial
    label: Use updated building code, commercial
  - id: develop_beyond_building_code
    label: Develop beyond building code
  - id: benchmark_energy_use
    label: Report and benchmark energy use

- id: action_change
  label: Changes caused by actions
  categories:
  - id: triggered
    label: Fraction triggered to change
  - id: compliant
    label: Fraction compliant with criteria
  - id: improvement
    label: Relative improvement

params:
- id: municipality_name
  value: longmont
- id: all_in_investment
  label: All investments happen on the first year (not continuously)
  is_customizable: false
  value: false
- id: discount_rate
  label: Discount rate (%/year)
  description: Speed of value decrease for monetary variables
  is_customizable: false
  value: 3.5
  min_value: 0
  max_value: 18
  step: 0.5
  unit: '%'
- id: renovation_rate_baseline
  label: Renovation rate baseline (%/year)
  is_customizable: false
  value: 0.5
  min_value: 0
  max_value: 2
  unit: '%/a'

emission_sectors:
- id: net_emissions
  name: Greenhouse gas emissions
  color: '#273E60'
  input_node_dimension:
    label: Emission sectors
  goals:
  - values:
    - year: 2050
      value: 335869.94
    default: true
    is_main_goal: true
  is_outcome: true
  description: <p>Greenhouse gas emissions</p><p><b>Unit:</b> t/yr. = metric tons
    per year</b></p>

# Sector emissions

- id: stationary_energy_emissions
  name: Stationary energy emissions
  part_of: net_emissions
  color: '#73C1B7'
  input_dataset_processors: [LinearInterpolation]

- id: transportation_emissions
  name: Transportation emissions
  part_of: net_emissions
  color: '#F4BD7B'
  input_dataset_processors: [LinearInterpolation]

- id: waste_emissions
  name: Waste emissions
  part_of: net_emissions
  color: '#D3805E'
  input_dataset_processors: [LinearInterpolation]

- id: ippu_emissions
  name: Industrial processes and product use emissions
  part_of: net_emissions
  color: '#6686B9'
  input_dataset_processors: [LinearInterpolation]

- id: afolu_emissions
  name: Agriculture, forestry, and other land use emissions
  category: afolu
  part_of: net_emissions
  color: '#5D9C6F'
  input_dataset_processors: [LinearInterpolation]

# Subsector emissions

- id: fugitive_emissions
  name: Fugitive emissions
  color: '#8DAFBC'
  part_of: stationary_energy_emissions
  input_dataset_processors: [LinearInterpolation]

- id: building_emissions
  name: Building emissions
  part_of: stationary_energy_emissions
  input_dataset_processors: [LinearInterpolation]

- id: waste_disposal_emissions
  name: Waste disposal emissions
  part_of: waste_emissions
  input_dataset_processors: [LinearInterpolation]

- id: waste_water_treatment_emissions
  name: Waste water treatment emissions
  category: waste_water_treatment
  part_of: waste_emissions
  input_dataset_processors: [LinearInterpolation]

- id: refridgerant_emissions
  name: Refridgerant emissions
  category: refridgerant
  part_of: ippu_emissions
  input_dataset_processors: [LinearInterpolation]

- id: on_road_transportation_emissions
  name: On-road transportation
  part_of: transportation_emissions
  input_dataset_processors: [LinearInterpolation]

- id: aviation_emissions
  name: Aviation emissions
  category: aviation
  part_of: transportation_emissions
  input_dataset_processors: [LinearInterpolation]

- id: railways_emissions
  name: Railways emissions
  category: railways
  part_of: transportation_emissions
  input_dataset_processors: [LinearInterpolation]

- id: off_road_transportation
  name: Off-road transportation
  category: off_road
  part_of: transportation_emissions
  input_dataset_processors: [LinearInterpolation]

- id: leakage_from_oil_and_gas_wells_emissions
  name: Emissions from leakages from oil and gas wells
  category: leakage_from_oil_and_gas_wells
  part_of: fugitive_emissions
  input_dataset_processors: [LinearInterpolation]

nodes:

- id: population
  name: Inhabitants
  description: Population estimates from several sources. (a) 2016 - 2020 population
    estimates came from the Colorado Demography Office. Spreadsheet on file. (b) According
    to Longmont's Envision Plan (2016), Longmont's population is expected to grow
    by 24,165 residents from 2016 numbers by 2035. Population figures between 2021
    and 2035 assume a linear increase. (c) Population estimates between 2036 and 2050
    are based off the estimated annual population increase rate for Boulder County
    between 2035 and 2050. This rate is 0.501%. Raw data was taken from <a href="https://demography.dola.colorado.gov/assets/html/county.html">Colorado
    Department of Local Affairs</a>.
  type: simple.AdditiveNode
  quantity: population
  unit: cap
  historical_values: [[2010, 86270], [2016, 92858], [2017, 94461], [2018, 96398],
    [2019, 96577], [2020, 99129], [2021, 99629]]
  forecast_values: [[2022, 101517], [2023, 102711], [2024, 103906], [2025, 105100],
    [2030, 111072], [2035, 117045], [2040, 120006], [2045, 123042], [2050, 126156]]
  input_dataset_processors: [LinearInterpolation]

- id: global_warming_potential_100a
  name: Global warming potential 100 a
  type: emissions.GlobalWarmingPotential
  quantity: emission_factor
  unit: dimensionless
  output_dimensions: [greenhouse_gases]
  input_dataset_processors: [LinearInterpolation]
  historical_values: [[1990, 1], [2021, 1]]

#
# STATIONARY
#
- id: building_square_footage
  name: Building square footage
  type: simple.AdditiveNode
  quantity: floor_area
  unit: ft^2
  input_datasets:
  - id: longmont/building_square_footage
    forecast_from: 2023
  input_dataset_processors: [LinearInterpolation]
  output_dimensions: [emission_sectors]

- id: building_electricity_use_historical
  name: Building electricity use (historical)
  type: buildings.HistoricalNode
  quantity: energy
  unit: GWh/a
  input_dimensions: [emission_sectors]
  output_dimensions: [emission_sectors]
  input_datasets:
  - id: longmont/stationary_energy_consumption
    column: electricity
  input_dataset_processors: [LinearInterpolation]

- id: building_electricity_use_per_resident
  name: Building electricity use per resident
  type: simple.DivisiveNode
  quantity: per_capita
  unit: GWh/a/cap
  input_nodes:
  - id: building_electricity_use_historical
  - id: population
    to_dimensions: []
  input_dimensions: [emission_sectors]
  output_dimensions: [emission_sectors]
  params:
    only_historical: true
    extend_rows: true

- id: building_electricity_use_bau
  name: Building electricity use (baseline)
  type: simple.MultiplicativeNode
  quantity: energy
  unit: GWh/a
  input_nodes:
  - id: building_electricity_use_per_resident
  - id: population
    to_dimensions: []
  input_dimensions: [emission_sectors]
  output_dimensions: [emission_sectors]

- id: building_natural_gas_use_historical
  name: Building natural gas use (historical)
  type: buildings.HistoricalNode
  quantity: energy
  unit: Mtherm/a
  input_dimensions: [emission_sectors]
  output_dimensions: [emission_sectors]
  input_datasets:
  - id: longmont/stationary_energy_consumption
    column: natural_gas
  input_dataset_processors: [LinearInterpolation]

- id: building_natural_gas_use_per_resident
  name: Building natural gas use per resident
  type: simple.DivisiveNode
  quantity: per_capita
  unit: Mtherm/a/cap
  input_nodes:
  - id: building_natural_gas_use_historical
  - id: population
    to_dimensions: []
  input_dimensions: [emission_sectors]
  output_dimensions: [emission_sectors]
  params:
    only_historical: true
    extend_rows: true

- id: building_natural_gas_use_bau
  name: Building natural gas use (baseline)
  type: simple.MultiplicativeNode
  quantity: energy
  unit: Mtherm/a
  input_nodes:
  - id: building_natural_gas_use_per_resident
  - id: population
    to_dimensions: []
  input_dimensions: [emission_sectors]
  output_dimensions: [emission_sectors]

- id: affected_square_footage
  name: Building square footage affected by actions
  description: Building square footeage affected by actions on each year. Fraction
    of compliant buildings is already taken into account here. Note that these values
    are not additive, as several actions may affect the same buildings. Those buildings
    that are not affected are not shown here.
  type: buildings.FloorAreaNode
  quantity: floor_area
  unit: ft^2
  input_nodes:
  - id: building_square_footage
    to_dimensions:
    - id: emission_sectors
  - id: updated_building_code
    metrics: [triggered, compliant]
    from_dimensions:
    - id: energy_carrier
      categories: [electricity]  # Any category, all are identical
      flatten: true
  - id: develop_beyond_building_code
    metrics: [triggered, compliant]
    from_dimensions:
    - id: energy_carrier
      categories: [electricity]
      flatten: true
  - id: benchmark_energy_use
    metrics: [triggered, compliant]
    from_dimensions:
    - id: energy_carrier
      categories: [electricity]
      flatten: true

- id: natural_gas_eui_improvement
  name: Energy use intensity EUI improvement for natural gas
  type: buildings.CfNode
  quantity: consumption_factor
  unit: therm/ft**2/a
  input_nodes:
  - id: building_natural_gas_eui
    to_dimensions:
    - id: emission_sectors
  - id: updated_building_code
    metrics: [improvement]
    from_dimensions:
    - id: energy_carrier
      categories: [natural_gas]
      flatten: true
  - id: develop_beyond_building_code
    metrics: [improvement]
    from_dimensions:
    - id: energy_carrier
      categories: [natural_gas]
      flatten: true
  - id: benchmark_energy_use
    metrics: [improvement]
    from_dimensions:
    - id: energy_carrier
      categories: [natural_gas]
      flatten: true

- id: natural_gas_saved
  name: Natural gas saved
  type: buildings.EnergyNode
  quantity: energy
  unit: Mthm/a
  params:
  - id: not_cumulated
    value: develop_beyond_building_code
  input_nodes:
  - id: affected_square_footage
  - id: natural_gas_eui_improvement

- id: natural_gas_temp1  # FIXME Replace this node with FormulaNode
  name: Natural gas (temporary)
  type: simple.FixedMultiplierNode
  quantity: energy
  unit: Mthm/a
  params:
  - id: multiplier
    value: -1
  input_nodes:
  - natural_gas_saved
  input_dimensions: [building_energy_class, action, emission_sectors]
  output_dimensions: [building_energy_class, action, emission_sectors]
  output_nodes:
  - id: building_natural_gas_use
    from_dimensions:
    - id: building_energy_class
      flatten: true
    - id: action
      flatten: true

- id: electricity_eui_improvement
  name: Energy use intensity EUI improvement for electricity
  type: buildings.CfNode
  quantity: consumption_factor
  unit: kWh/ft**2/a
  input_nodes:
  - id: building_electricity_eui
    to_dimensions:
    - id: emission_sectors
  - id: updated_building_code
    metrics: [improvement]
    from_dimensions:
    - id: energy_carrier
      categories: [electricity]
      flatten: true
  - id: develop_beyond_building_code
    metrics: [improvement]
    from_dimensions:
    - id: energy_carrier
      categories: [electricity]
      flatten: true
  - id: benchmark_energy_use
    metrics: [improvement]
    from_dimensions:
    - id: energy_carrier
      categories: [electricity]
      flatten: true

- id: electricity_saved
  name: Electricity saved
  type: buildings.EnergyNode
  quantity: energy
  unit: GWh/a
  params:
  - id: not_cumulated
    value: develop_deyond_building_code
  input_nodes:
  - id: affected_square_footage
  - id: electricity_eui_improvement

- id: electricity_temp1  # FIXME Replace this node with FormulaNode
  name: Electricity (temporary)
  type: simple.FixedMultiplierNode
  quantity: energy
  unit: GWh/a
  params:
  - id: multiplier
    value: -1
  input_nodes:
  - electricity_saved
  input_dimensions: [building_energy_class, action, emission_sectors]
  output_dimensions: [building_energy_class, action, emission_sectors]
  output_nodes:
  - id: building_electricity_use
    from_dimensions:
    - id: building_energy_class
      flatten: true
    - id: action
      flatten: true

- id: building_natural_gas_eui
  name: Energy use intensity EUI baseline for natural gas
  type: simple.AdditiveNode
  quantity: consumption_factor
  unit: therm/ft**2/a
  input_datasets:
  - id: longmont/building_energy_use_intensity_eui
    column: natural_gas
  input_nodes:
  - id: energy_use_intensity_trend
    metrics: [natural_gas]
  input_dimensions: [emission_sectors]
  output_dimensions: [emission_sectors]

- id: building_electricity_use
  name: Building electricity use
  description: <b>Unit:</b> GWh/yr. = gigawatt-hours per year = million kilowatt-hours
    per year.
  type: simple.MultiplyLastNode
  quantity: energy
  unit: GWh/a
  input_dimensions: [emission_sectors]
  output_dimensions: [emission_sectors]
  input_nodes:
  - id: building_electricity_use_bau

- id: building_natural_gas_use
  name: Building natural gas use
  description: <b>Unit:</b> Mthm/yr. = million therms per year.
  type: simple.MultiplyLastNode
  quantity: energy
  unit: Mtherm/a
  input_dimensions: [emission_sectors]
  output_dimensions: [emission_sectors]
  input_nodes:
  - id: building_natural_gas_use_bau

- id: electricity_use
  name: Electricity use
  description: <b>Unit:</b> GWh/yr. = gigawatt-hours per year = million kilowatt-hours
    per year.
  type: simple.MultiplyLastNode2
  quantity: energy
  unit: GWh/a
  input_dimensions: [emission_sectors]
  output_dimensions: [emission_sectors]
  input_nodes:
  - building_electricity_use

- id: electricity_emission_factor
  name: Emission factor of electricity production
  type: simple.AdditiveNode
  quantity: emission_factor
  unit: t/MWh
  input_datasets:
  - id: longmont/electricity_emission_factor
    filters:
    - column: site
      value: longmont_power
  input_dataset_processors: [LinearInterpolation]
  input_dimensions: [greenhouse_gases]
  output_dimensions: [greenhouse_gases]

- id: building_electricity_eui
  name: Energy use intensity EUI baseline for electricity
  type: simple.AdditiveNode
  quantity: consumption_factor
  unit: kWh/ft**2/a
  input_datasets:
  - id: longmont/building_energy_use_intensity_eui
    column: electricity
  input_nodes:
  - id: energy_use_intensity_trend
    metrics: [electricity]
  input_dimensions: [emission_sectors]
  output_dimensions: [emission_sectors]

# Building model, updated building code
# Floor area increses by B32 every year. categories residential, commercial
# Energy use intensity EUI improves every three years to the most recent IECC(?)
# Most recent IECC improves by C34 annually
# Existing building go through energy improvement 1 %
# New buildings: 90 % are compliant and have X % lower energy consumption
# Electricity and gas separately, for residential and commercial
# Energy saving = affected area * saved energy factor * compliant fraction; cumulatively
# Savings separately for new and existing buildings
# Emissions = energy * emission factors for electricity or natural gas (per ghg gas)

# Develop beyond bulding code
# New buildings only
# Estimated savings beyond IECC: goes from 0 to 100 % between 2017 and 2030
# energy efficiency = EUI with most recent IECC * (1-savings)
# Natural gas savings: subtract the impacts of electrification of heating
# Emissions = as above

# Report benchmark energy use
# Commercial area over 20000 sqft (increases by B33 every year)
# Percent participation: goes non-linearly fom 88 to 99 % between 2023 and  2029
# Percent saving: goes non-linearly from 2.4 to 0 % between 2023 and 2029; cumulatively
# Emissions = as above

# Expand the Efficiency Works Program
# Percent savings: after gradual increase 2016-2025, is constant C55.
# Energy = savings * total electricity consumption BAU!M44 (residence, commercial + losses)
# Emissions = as above

# Electrify buildings
# If time > electrification start year 2023, then use model input values for saving estimates
# Emission reduction is estimated to come from reduced natural gas, and the respective
# amount of additional electricity consumption is then added (with a factor conversion,
# but we want to rather use floor area changes)

- id: electricity_consumption_emissions
  name: Electricity consumption emissions
  type: simple.EmissionFactorActivity
  quantity: emissions
  unit: t/a
  color: '#4d9870'
  output_dimensions: [greenhouse_gases, emission_sectors]
  input_nodes:
  - id: electricity_use
    to_dimensions:
    - id: emission_sectors
  - id: electricity_emission_factor
    to_dimensions:
    - id: greenhouse_gases
  output_nodes:
  - id: building_emissions
    from_dimensions:
    - id: greenhouse_gases
      flatten: true
    - id: emission_sectors
      flatten: true
    to_dimensions:
    - id: emission_scope
      categories: [scope2]

- id: electricity_replacing_natural_gas_residential
  name: Electricity that replaces natural gas in residential buildings
  type: simple.FixedMultiplierNode
  quantity: energy
  unit: kWh/a
  params:
  - id: multiplier
    value: -0.33
  output_nodes:
  - id: building_electricity_use
    to_dimensions:
    - id: emission_sectors
      categories: [residential_energy]

- id: electricity_replacing_natural_gas_commercial
  name: Electricity that replaces natural gas in commercial buildings
  type: simple.FixedMultiplierNode
  quantity: energy
  unit: kWh/a
  params:
  - id: multiplier
    value: -0.39
  output_nodes:
  - id: building_electricity_use
    to_dimensions:
    - id: emission_sectors
      categories: [commercial_industrial_energy]

# Natural gas

- id: emission_factor_natural_gas
  name: Emission factor of natural gas
  type: simple.AdditiveNode
  quantity: emission_factor
  unit: t/Mthm
  input_datasets:
  - longmont/emission_factor_natural_gas
  input_dataset_processors: [LinearInterpolation]
  output_dimensions: [greenhouse_gases, energy_carrier]

- id: leakage_from_natural_gas_emissions
  name: Emissions from natural gas leakage
  category: leakage_from_natural_gas
  type: simple.FixedMultiplierNode
  quantity: emissions
  unit: t/a
  input_dimensions: [emission_sectors]
  output_dimensions: [emission_sectors]
  input_nodes:
  - building_natural_gas_use
  output_nodes:
  - id: fugitive_emissions
    from_dimensions:
    - id: emission_sectors
      flatten: true
    to_dimensions:
    - id: emission_scope
      categories: [scope1]
  params:
  - id: multiplier
    value: 0.18409014  # =(D47*100000/1028*0.02832*0.8*0.934/1000*0.003*'Emission Factors and Constants'!$C$21)+(D47*100000/1028*0.02832*0.8*0.01/1000*0.003) = D47 * 0.00018409014
    unit: kg/therm

- id: natural_gas_consumption_emissions
  name: Natural gas consumption emissions
  type: simple.EmissionFactorActivity
  quantity: emissions
  unit: t/a
  output_dimensions: [emission_sectors, greenhouse_gases, energy_carrier]
  input_nodes:
  - id: building_natural_gas_use
    to_dimensions:
    - id: emission_sectors
    - id: energy_carrier
      categories: [natural_gas]
  - id: emission_factor_natural_gas
    to_dimensions:
    - id: greenhouse_gases
    - id: energy_carrier
  output_nodes:
  - id: building_emissions
    from_dimensions:
    - id: energy_carrier
      flatten: true
    - id: greenhouse_gases
      flatten: true
    - id: emission_sectors
      flatten: true
    to_dimensions:
    - id: emission_scope
      categories: [scope1]

# Other fuels

- id: stationary_fuel_consumption
  name: Other stationary fuel consumption
  type: simple.AdditiveNode
  quantity: energy
  unit: gal/a
  input_datasets:
  - longmont/stationary_fuel_use
  input_dimensions: [emission_sectors, energy_carrier]
  output_dimensions: [emission_sectors, energy_carrier]

- id: emission_factor_fuel
  name: Emission factor of stationary fuels
  type: simple.AdditiveNode
  quantity: emission_factor
  unit: t/gal
  input_datasets:
  - longmont/emission_factor_fuels
  input_dataset_processors: [LinearInterpolation]
  output_dimensions: [energy_carrier, greenhouse_gases]

- id: stationary_fuel_consumption_emissions
  name: Stationary fuel consumption emissions
  description: <p>1) Stationary Diesel Use data was provided by CDPHE. Spreadsheet
    on file.</p> <p>2) Xcel Energy emission factor, electricity and natural gas usage
    data, and renewable energy data is from Xcel's 2021 Community Energy Report for
    Longmont, on file.</p> <p>3) Longmont Power & Communications data provided. PDF
    on file. The commercial buildings in Longmont's Weld County portion consumed 31,000,000
    kWh in 2021.</p> <p>4) T&D losses are calculated for Xcel and Longmont based on
    the EIA 861 (https://www.eia.gov/electricity/data/eia861/) reported data. Specifically
    the Utility Operational Data_2021. Spreadsheet on file.</p> <p>5) Propane data
    provided by FerrellGas. Spreadsheet on file.</p> <p>6) Houses heated with wood
    were pulled from the US Census Bureau, data on file. It was assumed that all of
    the houses heated by wood in Longmont fell within the Boulder County portion of
    Longmont.</p> <p>7) Longmont Power and Communications data was provided by Longmont
    Power & Communications. PDF on file.</p> <p>8) Longmont Power & Communications
    and Lyons Municipal rooftop solar data was provided in kW of capacity rather than
    kWh generated. NREL's PVWatts was used to estimate kWh generated by rooftop solar
    systems. PDF of results on file. See https://pvwatts.nrel.gov/</p> <p>10) Due
    to Xcel's 15/15 rule, with less than 15 customers in the commercial and residential
    data sets they cannot provide usage for those customers to avoid violating privacy
    concerns. Therefore Lotus applied the average residential and commercial kWh use
    from LPC to the 7 residential and commercial customers (respectively) in Xcel
    territory to estimate use.</p> <p>11) PRPA emission factor and transmission and
    distribution loss rate for 2021 was provided. Email on file. Emissions factor
    value represents Longmont's load share emissions rate without unbundled RECs.</p>
  type: simple.EmissionFactorActivity
  quantity: emissions
  unit: t/a
  output_dimensions: [greenhouse_gases, emission_sectors, energy_carrier]
  input_nodes:
  - id: stationary_fuel_consumption
    to_dimensions:
    - id: emission_sectors
    - id: energy_carrier
  - id: emission_factor_fuel
    to_dimensions:
    - id: greenhouse_gases
    - id: energy_carrier
  output_nodes:
  - id: building_emissions
    from_dimensions:
    - id: energy_carrier
      flatten: true
    - id: greenhouse_gases
      flatten: true
    - id: emission_sectors
      flatten: true
    to_dimensions:
    - id: emission_scope
      categories: [scope1]

# Wood

- id: stationary_wood_consumption
  name: Stationary wood consumption
  type: simple.AdditiveNode
  quantity: energy
  unit: MMBtu/a
  input_datasets:
  - longmont/stationary_wood_consumption
  input_dimensions: [emission_sectors]
  output_dimensions: [energy_carrier, emission_sectors]

- id: emission_factor_wood
  name: Emission factor of wood
  type: simple.AdditiveNode
  quantity: emission_factor
  unit: kg/MMBtu
  input_datasets:
  - longmont/emission_factor_wood
  output_dimensions: [energy_carrier, greenhouse_gases]

- id: wood_consumption_emissions
  name: Wood consumption emissions
  type: simple.EmissionFactorActivity
  quantity: emissions
  unit: t/a
  output_dimensions: [greenhouse_gases, emission_sectors, energy_carrier]
  input_nodes:
  - id: stationary_wood_consumption
    to_dimensions:
    - id: emission_sectors
    - id: energy_carrier
  - id: emission_factor_wood
    to_dimensions:
    - id: greenhouse_gases
    - id: energy_carrier
  output_nodes:
  - id: building_emissions
    from_dimensions:
    - id: energy_carrier
      flatten: true
    - id: greenhouse_gases
      flatten: true
    - id: emission_sectors
      flatten: true
    to_dimensions:
    - id: emission_scope
      categories: [scope1]

# Losses

- id: electricity_loss_fraction
  name: Electricity loss fraction
  type: simple.AdditiveNode
  quantity: fraction
  unit: '%'
  input_datasets:
  - id: longmont/transmission_and_distribution_loss
    filters:
    - column: site
      value: longmont_power
  output_dimensions: [energy_carrier]
  output_nodes:
  - id: electricity_losses
    from_dimensions:
    - id: energy_carrier
      categories: [electricity]
      flatten: true
    to_dimensions: []

- id: electricity_losses
  name: Electricity losses
  type: simple.MultiplicativeNode
  quantity: energy
  unit: GWh/a
  input_dimensions: [emission_sectors]
  output_dimensions: [emission_sectors]
  input_nodes:
  - id: electricity_use
    tags: [non_additive]
    to_dimensions:
    - id: emission_sectors

- id: electricity_loss_emissions
  name: Emissions due to electricity losses
  type: simple.EmissionFactorActivity
  quantity: emissions
  unit: t/a
  input_nodes:
  - id: electricity_losses
    to_dimensions:
    - id: emission_sectors
  - id: electricity_emission_factor
    to_dimensions:
    - id: greenhouse_gases
  output_dimensions: [emission_sectors, greenhouse_gases]
  output_nodes:
  - id: electricity_consumption_emissions
    to_dimensions:
    - id: emission_sectors
    - id: greenhouse_gases

#
# TRANSPORTATION
#

- id: emission_factor_fuels
  name: Fuel emission factors for CO2
  type: simple.AdditiveNode
  quantity: emission_factor
  unit: kg/gal
  input_datasets:
  - longmont/emission_factor_fuels
  input_dimensions: [energy_carrier, greenhouse_gases]
  output_dimensions: [energy_carrier, greenhouse_gases]

- id: registered_vehicles
  name: Registered vehicles
  type: simple.FixedMultiplierNode
  quantity: number
  unit: vehicle
  input_nodes:
  - population
  params:
  - id: multiplier
    value: 0.8140
    unit: vehicle/person
    is_customizable: false

- id: miles_per_gallon
  name: Miles per gallon
  type: simple.AdditiveNode
  quantity: fuel_consumption
  unit: miles/gallon
  input_datasets:
  - longmont/miles_per_gallon

- id: vehicle_miles_per_vehicle
  name: Vehicle miles per vehicle
  description: '<p>The model has two different estimates for VMT: <ul><li>Row 50:
    Average annual VMT per Vehicle (from BAU, year 2018) 4,671.6 mi/vehicle/a</li>
    <li>Row 76: Average annual VMT (from assumption, year 2018) 7,982 mi/vehicle/a</li></ul></p>
    <p><b>Unit:</b> mi/(yr. v) = miles per year per vehicle</p>'
  type: simple.AdditiveNode
  quantity: mileage
  unit: miles/vehicle/a
  input_datasets:
  - longmont/annual_vehicle_miles_per_vehicle

- id: registered_electric_vehicles
  name: Registered electric vehicles
  type: simple.AdditiveNode
  quantity: number
  unit: vehicle
  input_datasets:
  - longmont/registered_electric_vehicles

- id: registered_non_electric_vehicles
  name: Registered non-electric vehicles
  type: simple.SubtractiveNode
  quantity: number
  unit: vehicle
  input_nodes:
  - registered_vehicles
  - registered_electric_vehicles

- id: total_vehicle_miles_traveled
  name: Total combustion engine vehicle miles traveled
  description: <p><b>Unit:</b> Mmi/yr. = million miles per year (possibly cap. = per
    capita)</p>
  type: simple.MultiplicativeNode
  quantity: mileage
  unit: Mmiles/a
  input_nodes:
  - vehicle_miles_per_vehicle
  - registered_non_electric_vehicles

- id: non_electric_vehicle_fuel_use
  name: Non-electric vehicle fuel use
  type: simple.DivisiveNode
  quantity: energy
  unit: gallons/a
  input_nodes:
  - total_vehicle_miles_traveled
  - miles_per_gallon

- id: vehicle_fuel_emissions
  name: Vehicle fuel emissions
  type: simple.MultiplicativeNode
  quantity: emissions
  unit: kt/a
  input_dimensions: [energy_carrier, greenhouse_gases]
  output_dimensions: [energy_carrier, greenhouse_gases]
  input_nodes:
  - id: non_electric_vehicle_fuel_use
    to_dimensions:
    - id: energy_carrier
      categories: [petrol]
  - id: emission_factor_fuels
    to_dimensions:
    - id: energy_carrier
    - id: greenhouse_gases
  output_nodes:
  - id: on_road_transportation_emissions
    from_dimensions:
    - id: greenhouse_gases
      flatten: true
    - id: energy_carrier
      flatten: true
    to_dimensions:
    - id: emission_scope
      categories: [scope1]

- id: vehicle_electricity_emissions
  name: Vehicle electricity emissions
  type: simple.MultiplicativeNode
  quantity: emissions
  unit: kt/a
  input_dimensions: [greenhouse_gases]
  output_dimensions: [greenhouse_gases]
  input_nodes:
  - id: vehicle_electricity_use
    from_dimensions:
    - id: emission_sectors
      flatten: true
    to_dimensions: []
  - id: electricity_emission_factor
    to_dimensions:
    - id: greenhouse_gases
  output_nodes:
  - id: on_road_transportation_emissions
    from_dimensions:
    - id: greenhouse_gases
      flatten: true
    to_dimensions:
    - id: emission_scope
      categories: [scope1]

- id: electric_vehicle_efficiency
  name: Electric vehicle efficiency
  type: simple.AdditiveNode
  quantity: fuel_consumption
  unit: kWh/mile
  input_datasets:
  - longmont/electric_vehicle_efficiency

- id: vehicle_electricity_use
  name: Vehicle electricity use
  description: <b>Unit:</b> kWh/yr. = kilowatt-hours per year.
  type: simple.MultiplicativeNode
  quantity: energy
  unit: kWh/a
  input_dimensions: [emission_sectors]
  output_dimensions: [emission_sectors]
  input_nodes:
  - id: registered_electric_vehicles
    to_dimensions: []
  - id: vehicle_miles_per_vehicle
    to_dimensions: []
  - id: electric_vehicle_efficiency
    to_dimensions: []
  - vehicle_charging_shares

- id: vehicle_charging_shares
  name: Vehicle charging shares
  type: simple.AdditiveNode
  quantity: fraction
  unit: '%'
  input_datasets:
  - longmont/vehicle_charging_shares
  output_dimensions: [emission_sectors]

- id: free_rides_per_person
  name: Rides per person from Ride Free program
  type: simple.AdditiveNode
  quantity: number
  unit: trip/inhabitant/a
  historical_values: [[2016, 1.101064], [2017, 1.101064], [2018, 1.101064], [2019,
      1.101064], [2020, 1.101064], [2021, 1.101064], [2022, 1.101064], [2023, 0]]

- id: ridership_program
  name: Ridership from Ride Free program
  type: simple.MultiplicativeNode
  quantity: number
  unit: trip/a
  input_nodes:
  - free_rides_per_person
  - population

- id: vmt_change_due_to_public_transportation
  name: Change in vehicle miles traveled due to public transportation
  type: simple.FixedMultiplierNode
  quantity: mileage
  unit: miles/a
  input_nodes:
  - public_transportation_trips
  params:
  - id: multiplier
    value: -8.8
    unit: miles/trip
  output_nodes:
  - total_vehicle_miles_traveled

- id: modal_share_of_active_transportation
  name: Modal share of active transportation
  type: simple.AdditiveNode
  quantity: fraction
  unit: '%'
  historical_values: [[2016, 10.0], [2017, 10], [2018, 10], [2019, 10], [2020, 10],
    [2021, 10]]

- id: vmt_change_from_active_transportation
  name: Change in vehicle miles traveled due to active transportation
  type: simple.ImprovementNode
  quantity: mileage
  unit: dimensionless
  input_nodes:
  - modal_share_of_active_transportation
  output_nodes:
  - id: total_vehicle_miles_traveled
    tags: [non_additive]

- id: public_transportation_change
  name: Public transportation change by last-mile actions
  description: This is an intermediate node converting the action into a relative
    amount of trips (business-as-usual = 1).
  type: simple.ImprovementNode2
  quantity: ratio
  unit: dimensionless
  historical_values: [[2016, 1.0], [2021, 1.9]]
  input_dataset_processsors: [LinearInterpolation]

- id: public_transportation_trips_per_person
  name: Public transportation trips per person
  description: Without further actions, the number of public transportation trips
    per person is assumed to be constant and at the level of 2017.
  type: simple.FixedMultiplierNode
  quantity: number
  unit: trips/inhabitant/a
  historical_values: [[2016, 5.890474806], [2017, 5.890474806], [2018, 5.906333777],
    [2019, 5.922192747], [2020, 5.938051718], [2021, 5.953910689]]
  input_nodes:
  - public_transportation_change
  params:
  - id: multiplier
    value: 5.890474806
    unit: trip/inhabitant/a
  - id: replace_output_using_input_dataset
    value: true

- id: public_transportation_trips
  name: Public transportation trips
  type: simple.MultiplicativeNode
  quantity: number
  unit: trip/a
  input_nodes:
  - population
  - public_transportation_trips_per_person
  - ridership_program

### WASTE

- id: amount_of_waste_per_person
  name: Amount of waste per person
  type: simple.AdditiveNode
  quantity: mass
  unit: short_ton/inhabitant/a
  input_datasets:
  - longmont/amount_of_waste
  input_dataset_processors: [LinearInterpolation]
  output_dimensions: [waste]

- id: amount_of_waste
  name: Total amount of waste
  type: simple.MultiplicativeNode
  quantity: mass
  unit: short_ton/a
  input_dimensions: [waste]
  output_dimensions: [waste]
  input_nodes:
  - id: amount_of_waste_per_person
  - id: population
    to_dimensions: []

- id: diversion_rate
  name: Diversion rate
  type: simple.AdditiveNode
  quantity: fraction
  unit: '%'
  historical_values: [[2016, 22.1], [2017, 22.1], [2018, 27.2], [2019, 27.2], [2020,
      31.1], [2021, 35.0]]

- id: waste_diversion
  name: Fraction of non-diverted waste
  type: simple.ImprovementNode
  quantity: fraction
  unit: dimensionless
  input_nodes:
  - diversion_rate

- id: amount_of_non_diverted_waste
  name: Amount of non-diverted waste
  type: simple.MultiplicativeNode
  quantity: mass
  unit: short_ton/a
  input_nodes:
  - id: amount_of_waste
    tags: [non_additive]
    from_dimensions:
    - id: waste
      categories: [landfilled]
      flatten: true
  - id: waste_diversion
    tags: [non_additive]

- id: waste_emission_factor
  name: Waste emission factor
  type: simple.AdditiveNode
  quantity: emission_factor
  unit: kg/short_ton
  historical_values: [[2016, 10.0], [2017, 10], [2018, 10], [2019, 6], [2020, 6],
    [2021, 6]]

- id: landfill_emissions
  name: Landfill emissions
  type: simple.MultiplicativeNode
  quantity: emissions
  unit: metric_ton/a
  input_dimensions: [greenhouse_gases]
  output_dimensions: [greenhouse_gases]
  input_nodes:
  - id: amount_of_non_diverted_waste
    tags: [non_additive]
    to_dimensions:
    - id: greenhouse_gases
      categories: [ch4]
  - id: waste_emission_factor
    to_dimensions:
    - id: greenhouse_gases
      categories: [ch4]
  - id: global_warming_potential_100a
  output_nodes:
  - id: waste_disposal_emissions
    from_dimensions:
    - id: greenhouse_gases
      flatten: true
    to_dimensions:
    - id: emission_scope
      categories: [scope3]

- id: participation_smart_grid
  name: Participation in smart grid projects
  type: simple.AdditiveNode
  quantity: fraction
  unit: '%'
  historical_values: [[2016, 0], [2017, 0], [2018, 2], [2019, 5], [2020, 7], [2021,
      9]]

- id: smart_grid_improvement
  name: Relative improvement due to smart grid implementation
  type: simple.AdditiveNode
  quantity: fraction
  unit: '%'
  historical_values: [[2016, 0], [2017, 0], [2018, 0], [2019, 0], [2020, 0], [2021,
      0]]

- id: smart_grid_benefits
  name: Smart grid action benefits
  type: simple.ImprovementNode
  quantity: fraction
  unit: dimensionless
  historical_values: [[2016, 1.0], [2017, 1], [2018, 1], [2019, 1], [2020, 1]]
  input_nodes:
  - id: participation_smart_grid
    tags: [non_additive]
  - id: smart_grid_improvement
    tags: [non_additive]
  output_nodes:
  - id: electricity_use
    to_dimensions: []

- id: transmission_loss_change
  name: Transmission loss changes
  type: simple.AdditiveNode
  quantity: fraction
  unit: '%'
  historical_values: [[2016, 0.0], [2017, 0], [2018, 0], [2019, 0], [2020, 0], [2021,
      0], [2022, 0]]

- id: transmission_loss_work_benefits
  name: Improvements due to transmission loss work
  description: Relative change of electricity use compared with the business as usual
    (baseline = 1).
  type: simple.ImprovementNode
  quantity: fraction
  unit: dimensionless
  historical_values: [[2016, 1.0], [2017, 1], [2018, 1], [2019, 1], [2020, 1], [2021,
      1], [2022, 1]]
  input_nodes:
  - id: transmission_loss_change
    tags: [non_additive]
  output_nodes:
  - id: electricity_use

actions:

- id: updated_building_code
  name: Use updated building code and enforce
  description: '<p>Adopting and enforcing the latest International Energy Conservation
    Code (IECC) every year a new IECC is released will increase efficiency.</p> <p>The
    graph shows the relative improvement of the energy use intensity (EUI) caused
    by this action.</p> <p>Track Implementation: <ul><li><a href="https://indicators.longmontcolorado.gov/sustainability/actions/BI-5">Sustainability
    Plan Strategy BI-5</a></li></ul></p>'
  type: energy_saving.CfFloorAreaAction
  quantity: consumption_factor
  group: buildings
  input_datasets:
  - id: longmont/energy_use_intensity_with_building_actions
    tags: [floor]
    forecast_from: 2023
    filters:
    - column: action
      value: updated_building_code
#  - id: longmont/energy_use_intensity_improvements  # Alternative, absolute data
  - id: longmont/energy_use_intensity_relative
    tags: [improvement]
    forecast_from: 2023
    filters:
    - column: action
      value: updated_building_code
  output_dimensions: [emission_sectors, building_energy_class, energy_carrier]
#  params:  # For absolute data
#  - id: natural_gas_unit
#    value: thm/ft**2/a
#  - id: electricity_unit
#    value: kWh/ft**2/a

- id: develop_beyond_building_code
  name: Develop beyond building code
  description: '<p>Develop building codes that go beyond the IECC and towards net-zero
    energy use, including the Climate Action Recommendations Report strategies to
    add solar ready and electric vehicle ready as part of the 2021 residential code
    update.</p> <p>The graph shows the relative improvement of the energy use intensity
    (EUI) caused by this action.</p> <p>Track Implementation: <ul><li><a href="https://indicators.longmontcolorado.gov/sustainability/actions/BI-6">Sustainability
    Plan Strategy BI-6</a></li></ul></p>'
  type: energy_saving.CfFloorAreaAction
  quantity: consumption_factor
  group: buildings
  input_datasets:
  - id: longmont/energy_use_intensity_with_building_actions
    tags: [floor]
    filters:
    - column: action
      value: develop_beyond_building_code
  - id: longmont/energy_use_intensity_relative
    tags: [improvement]
    forecast_from: 2023
    filters:
    - column: action
      value: develop_beyond_building_code
  output_dimensions: [emission_sectors, building_energy_class, energy_carrier]

- id: benchmark_energy_use
  name: Report and benchmark energy use in commercial buildings
  description: '<p>Requires commercial and industrial buildings owners whose buildings
    exceed 20,000 square feet to rate their building s energy use, report energy metrics,
    and encourages buildings owners to implement energy efficiency measures.</p> <p>The
    graph shows the relative improvement of the energy use intensity (EUI) caused
    by this action.</p> <p>Track Implementation: <ul><li><a href="https://indicators.longmontcolorado.gov/sustainability/actions/E-5">Sustainability
    Plan Strategy E-5</a></li></ul>'
  type: energy_saving.CfFloorAreaAction
  quantity: consumption_factor
  group: buildings
  input_datasets:
  - id: longmont/energy_use_intensity_with_building_actions
    tags: [floor]
    filters:
    - column: action
      value: benchmark_energy_use
  - id: longmont/energy_use_intensity_relative
    tags: [improvement]
    forecast_from: 2023
    filters:
    - column: action
      value: benchmark_energy_use
  output_dimensions: [emission_sectors, building_energy_class, energy_carrier]

- id: efficiency_works_program
  name: Expand the Efficiency Works Program
  description: '<p>Expand the Efficiency Works Program to achieve 2% energy savings
    by 2025 through commercial retro-commissioning, low-income programs, and residential
    and commercial savings.</p> <p>Track Implementation: <ul><li><a href="https://indicators.longmontcolorado.gov/sustainability/actions/E-1">Municipal:
    Sustainability Plan Strategy E-1</a></li> <li>Commercial: <a href="https://indicators.longmontcolorado.gov/sustainability/actions/E-3">Sustainability
    Plan Strategy E-3</a></li> <li>Residential: <a href="https://indicators.longmontcolorado.gov/sustainability/actions/E-7">Sustainability
    Plan Strategy E-7 </a></li> <li>Income-Qualified: <a href="https://indicators.longmontcolorado.gov/sustainability/actions/E-2">Sustainability
    Plan Strategy E-2</a></li> and <a href="https://indicators.longmontcolorado.gov/sustainability/actions/BI-2">Strategy
    BI-2</a></li></ul>'
  type: simple.AdditiveAction
  quantity: fraction
  unit: '%'
  group: buildings
  input_datasets:
  - id: longmont/efficiency_works_program
    forecast_from: 2023
    column: fraction
  output_nodes:
  - id: building_electricity_use
    tags: [non_additive]
  - id: building_natural_gas_use
    tags: [non_additive]

- id: replace_natural_gas_residential
  name: Beneficial Building Electrification Residential
  description: '<p>Converting residential building systems that use fossil fuels (gas,
    oil, or propane) to high efficiency electric equipment powered by increasingly
    clean and renewable electricity.</p> <p>Track Implementation: <ul><li><a href="https://indicators.longmontcolorado.gov/bbe">Beneficial
    Building Electrification Plan</a></li></ul>'
  type: simple.AdditiveAction
  quantity: energy
  unit: ktherm/a
  group: buildings
  input_datasets:
  - id: longmont/energy_vehicle_and_waste_actions
    forecast_from: 2022
    column: replace_natural_gas_residential
  output_nodes:
  - id: building_natural_gas_use
    to_dimensions:
    - id: emission_sectors
      categories: [residential_energy]
  - id: electricity_replacing_natural_gas_residential

- id: replace_natural_gas_commercial
  name: Beneficial Building Electrification Commercial
  description: '<p>Converting commercial building systems that use fossil fuels (gas,
    oil, or propane) to high efficiency electric equipment powered by increasingly
    clean and renewable electricity.</p> <p>Track Implementation: <ul><li><a href="https://indicators.longmontcolorado.gov/bbe">Beneficial
    Building Electrification Plan</a></li></ul>'
  type: simple.AdditiveAction
  quantity: energy
  unit: ktherm/a
  group: buildings
  input_datasets:
  - id: longmont/energy_vehicle_and_waste_actions
    forecast_from: 2022
    column: replace_natural_gas_commercial
  output_nodes:
  - id: building_natural_gas_use
    to_dimensions:
    - id: emission_sectors
      categories: [commercial_industrial_energy]
  - id: electricity_replacing_natural_gas_commercial

- id: longmont_power_renewables
  name: 90% renewable electric energy supply by 2030
  description: "<p>On January 9th, 2018, City Council passed a <a href=\"http://www.longmontcolorado.gov/home/showpublisheddocument/24804/636728893554700000\"\
    >resolution</a> to commit Longmont to 100% renewable electric energy supply by
    2030.</p> <p>This action only models to 90% as according to latte River Power
    Authority's most recent integrated resource plan, existing technology will only
    help Platte River reach 90% noncarbon by 2030.</p> <p>To model the 100% renewable
    electric energy supply goal, select this action and <a href=\"https://longmont.paths.staging.kausal.tech/actions/longmont_power_renewables_additional\"\
    >Additional 10% renewable electric energy supply by 2030</a>.</p> <p>Track Implementation:
    <ul><li><a href=\"https://longmont-envision.watch-test.kausal.tech/indicators/1674\"\
    >Renewable Energy Indicator</a></li> <li><a href=\"https://www.longmontcolorado.gov/departments/departments-e-m/longmont-power-communications/electric-service/renewable-energy\"\
    >Longmont Renewable Energy</a></li></ul></p>"
  type: simple.AdditiveAction
  quantity: emission_factor
  unit: t/MWh
  group: electric_grid
  input_datasets:
  - id: longmont/energy_vehicle_and_waste_actions
    forecast_from: 2022
    column: longmont_power_renewables
  output_nodes:
  - id: electricity_emission_factor
    to_dimensions:
    - id: greenhouse_gases
      categories: [co2]

- id: longmont_power_renewables_additional
  name: Additional 10% renewable electric energy supply by 2030
  description: "<p>On January 9th, 2018, City Council passed a <a href=\"http://www.longmontcolorado.gov/home/showpublisheddocument/24804/636728893554700000\"\
    >resolution</a> to commit Longmont to 100% renewable electric energy supply by
    2030.</p> <p>This action models the additional 10% renewable energy to meet City
    Council's goal of 100% renewable electric energy supply by 2030.</p> <p>To model
    the 100% renewable electric energy supply goal, select this action and <a href=\"\
    https://longmont.paths.staging.kausal.tech/actions/longmont_power_renewables\"\
    >90% renewable electric energy supply by 2030</a>.</p> <p>Track Implementation:
    <ul><li><a href=\"https://longmont-envision.watch-test.kausal.tech/indicators/1674\"\
    >Renewable Energy Indicator</a></li> <li><a href=\"https://www.longmontcolorado.gov/departments/departments-e-m/longmont-power-communications/electric-service/renewable-energy\"\
    >Longmont Renewable Energy</a></li></ul></p>"
  type: linear.ReduceAction
  quantity: emission_factor
  unit: t/MWh
  group: electric_grid
  output_nodes:
  - electricity_emission_factor
  params:
  - id: reduce
    unit: t/MWh
    is_customizable: false
    value:
    - target:
        node: electricity_emission_factor
        categories:
          greenhouse_gases: co2
      amounts:
      - year: 2023
        amount: -0.0107  # 0.867 / 8
      - year: 2030
        amount: -0.0107
      - year: 2031
        amount: 0

- id: smart_grid_projects
  name: Accelerate and implement smart grid projects
  description: '<p>Implement a variety of smart grid projects that encourage reductions
    in electricity consumption through real-time feedback, dynamic pricing, etc.</p>
    <p>Track Implementation: <ul><li><a href="https://indicators.longmontcolorado.gov/sustainability/actions/E-7">Sustainability
    Plan Strategy E-7</a></li></ul>'
  type: linear.ReduceAction
  quantity: ratio
  unit: '%'
  group: electric_grid
  output_nodes:
  - id: participation_smart_grid
  - id: smart_grid_improvement
  params:
  - id: reduce
    unit: '%'
    is_customizable: false
    value:
    - target:
        node: participation_smart_grid
      amounts:
      - year: 2022
        amount: 2.675  # (30-9)/8
      - year: 2029
        amount: 2.675
      - year: 2030
        amount: 0
    - target:
        node: smart_grid_improvement
      amounts:
      - year: 2022
        amount: 3.3
      - year: 2024
        amount: 3.3
      - year: 2025
        amount: 0

- id: reduce_transmission_distribution_losses
  name: Encourage practices that reduce transmission and distribution losses
  description: '<p>Reduce electric grid transmission and distribution losses through
    grid management such as distributed voltage optimization.</p> <p>Track Implementation:
    <ul><li><a href="https://indicators.longmontcolorado.gov/carr/actions/RE.5">Climate
    Action Recommendations Report RE.5</a></li></ul></p>'
  type: linear.ReduceAction
  quantity: ratio
  unit: '%'
  group: electric_grid
  output_nodes:
  - id: transmission_loss_change
  params:
  - id: reduce
    unit: '%'
    is_customizable: false
    value:
    - target:
        node: transmission_loss_change
      amounts:
      - year: 2023
        amount: 1.5
      - year: 2024
        amount: 0.0

- id: vehicle_incentives
  name: Increase electric vehicles through vehicle incentives and improved infrastructure
  description: '<p>Transition 30% of all vehicles registered within the City to zero-emissions
    by 2030, and near-100% of all vehicles by 2050 as stated in the <a href="https://www.longmontcolorado.gov/home/showpublisheddocument/34513/637685042384830000">2021
    GoEV Resolution.</a></p> <p>Track Implementation: <ul><li><a href="https://indicators.longmontcolorado.gov/sustainability/actions/T-4">Sustainability
    Plan Strategy T-4</a></li> <li><a href="https://longmont-sca.watch-test.kausal.tech/indicators/1771">Electric
    Vehicle Indicator</a></li></ul></p><p><b>Unit:</b> v = number of vehicles</p>'
  type: simple.AdditiveAction
  quantity: number
  unit: vehicle
  group: transportation
  input_datasets:
  - id: longmont/energy_vehicle_and_waste_actions
    forecast_from: 2022
    column: vehicle_incentives
  output_nodes:
  - registered_electric_vehicles

- id: increase_access_of_public_transit
  name: Address barriers to increase access and use of public transit
  description: '<p>Address barriers to increase access and use of public transit,
    especially for underserved communities.</p> <p>Track Implementation: <ul><li><a
    href="https://indicators.longmontcolorado.gov/transportation">Equitable Carbon-Free
    Transportation Roadmap</a></li> <li><a href="https://indicators.longmontcolorado.gov/sustainability/actions/T-1">Sustainability
    Plan Strategy T-1</a>, <a href="https://indicators.longmontcolorado.gov/sustainability/actions/T-5">Strategy
    T-5</a> and <a href="https://indicators.longmontcolorado.gov/sustainability/actions/T-7">Strategy
    T-7</a></li> <li><a href="https://indicators.longmontcolorado.gov/envision/guiding-principle/gp2-a-complete-balanced-and-connected-transportation-system">Envision
    Longmont Guiding Principle A Complete, Balanced, and Connected Transportation
    System</a></li></ul></p>'
  type: simple.AdditiveAction
  quantity: number
  unit: trip/inhabitant/a
  group: transportation
  forecast_values: [[2023, 1.101064], [2050, 1.101064]]
  input_dataset_processors: [LinearInterpolation]
  output_nodes:
  - free_rides_per_person

- id: multimodal_transportation_system
  name: Develop multimodal transportation system / bicycle and pedestrian improvements
  description: "<p>Pursue all elements of Longmont's multimodal transportation plan.
    This action specifically models from actively reduce greenhouse gas emissions
    through bicycle and pedestrian improvements.</p> <p>Track Implementation: <ul><li><a
    href=\"https://indicators.longmontcolorado.gov/transportation\">Equitable
    Carbon-Free Transportation Roadmap</a></li> <li><a href=\"https://indicators.longmontcolorado.gov/envision/guiding-principle/gp2-a-complete-balanced-and-connected-transportation-system\"\
    >Envision Longmont Guiding Principle A Complete, Balanced, and Connected Transportation
    System</a></li></ul></p>"
  type: simple.AdditiveAction
  quantity: fraction
  unit: '%'
  group: transportation
  forecast_values: [[2023, 0], [2050, 15]]
  input_dataset_processors: [LinearInterpolation]
  output_nodes:
  - modal_share_of_active_transportation

- id: last_mile_connections
  name: Improve last mile connections
  description: "<p>Pursue all elements of Longmont's multimodal transportation plan.
    This action specifically models from actively reduce greenhouse gas emissions
    through improving first/last mile connections.</p> <p>Track Implementation: <ul><li><a
    href=\"https://indicators.longmontcolorado.gov/transportation\">Equitable
    Carbon-Free Transportation Roadmap</a></li> <ul><li><a href=\"https://indicators.longmontcolorado.gov/envision/guiding-principle/gp2-a-complete-balanced-and-connected-transportation-system\"\
    >Envision Longmont Guiding Principle A Complete, Balanced, and Connected Transportation
    System</a></li></ul></p>"
  type: simple.AdditiveAction
  quantity: fraction
  unit: '%'
  group: transportation
  input_datasets:
  - id: longmont/energy_vehicle_and_waste_actions
    forecast_from: 2022
    column: last_mile_connections
  output_nodes:
  - public_transportation_change

- id: leak_detection
  name: Adopt and enforce leak detection and repair
  description: '<p>This action tracks emission reductions from monitoring active oil
    and gas sites by increasing methane leak detection and repair and minimizing leaks
    in the transmission and distribution system of natural gas. Currently the City
    has no active oil and gas sites.</p> <p>Track Implementation: <ul><li><a href="https://indicators.longmontcolorado.gov/sustainability/topic-area/aq-air-quality">Sustainability
    Plan Air Quality Strategies</a></li></ul></p>'
  type: simple.AdditiveAction
  quantity: emissions
  unit: t/a
  group: oil_and_gas
  forecast_values: [[2023, 0], [2050, 0]]
  output_nodes:
  - id: leakage_from_oil_and_gas_wells_emissions
    to_dimensions:
    - id: emission_scope
      categories: [scope1]

- id: increase_waste_diversion
  name: Increase waste diversion
  description: '<p>Achieve 75% waste diversion from the landfill by 2030 and 95% by
    2050 established in the <a href="https://www.longmontcolorado.gov/home/showpublisheddocument/35431/638001469478900000">2022
    Zero Waste Resolution</a>.</p> <p>Track Implementation: <ul><li><a href="https://indicators.longmontcolorado.gov/sustainability/topic-area/waste">Sustainability
    Plan Waste Strategies</a></li></ul></p>'
  type: simple.AdditiveAction
  quantity: fraction
  unit: '%'
  group: solid_waste
  input_datasets:
  - id: longmont/energy_vehicle_and_waste_actions
    forecast_from: 2022
    column: increase_waste_diversion
  output_nodes:
  - diversion_rate

- id: mpg_trend
  name: Miles per gallon increasing trend
  description: The model assumes that internal combustion vehicles that use gasoline
    and diesel will become more efficient, increase miles traveled per gallon, over
    time.
  type: simple.AdditiveAction
  quantity: fuel_consumption
  unit: miles/gallon
  group: trend
  input_datasets:
  - id: longmont/energy_vehicle_and_waste_actions
    forecast_from: 2022
    column: mpg_trend
  output_nodes:
  - miles_per_gallon

- id: vmt_per_vehicle_trend
  name: Vehicle miles per vehicle trend
  description: <p>The model assumes that overtime there will be a decrease in the
    annual miles traveled per vehicle.</p> <p><b>Unit:</b> mi/(yr. v) = miles per
    year per vehicle</p>
  type: simple.AdditiveAction
  quantity: mileage
  unit: miles/vehicle/a
  group: trend
  input_datasets:
  - id: longmont/energy_vehicle_and_waste_actions
    forecast_from: 2022
    column: vmt_per_vehicle_trend
  output_nodes:
  - vehicle_miles_per_vehicle

- id: electric_vehicle_efficiency_trend
  name: Electric vehicle efficiency trend
  description: The model assumes that electric vehicles will become more efficient,
    increase in miles traveled per kilowatt hour of energy, overtime.
  type: simple.AdditiveAction
  quantity: fuel_consumption
  unit: kWh/mile
  group: trend
  input_datasets:
  - id: longmont/energy_vehicle_and_waste_actions
    forecast_from: 2022
    column: electric_vehicle_efficiency_trend
  output_nodes:
  - electric_vehicle_efficiency

- id: energy_use_intensity_trend
  name: Energy use intensity trend
  description: This action describes the assumed improvement in the energy use intensity
    for the baseline scenario, i.e. changes that will occur anyway without any activity
    from the city.
  type: energy_saving.EnergyAction
  quantity: consumption_factor
  group: trend
  input_datasets:
  - id: longmont/energy_use_intensity_improvements
    filters:
    - column: action
      value: none
    forecast_from: 2023
  output_dimensions: [emission_sectors]

pages:
- id: home
  name: Longmont Greenhouse Gas Inventory
  path: /
  type: emission
  outcome_node: net_emissions

- id: updating
  name: Updating Guide
  path: /updating
  lead_paragraph_en: <p>This page provides instructions on how to update this tool
    and which values can be updated. A general set of directions is provided, followed
    by a table documenting which values on each tab can be updated and when it is
    appropriate to do so.</p> <p><b>Updating the Model</b></p> <p>The purpose of this
    model is to demonstrate the GHG reduction potential of Longmont''s strategies
    compared to Business-As-Usual emissions (if no strategies were implemented) based
    on a 2016 or 2018 baseline. Updates to this model should be decided based on the
    below criteria.</p> <p>The model should NOT be updated for the following reasons.</p>
    <li> <ul>Future GHG emissions inventories. The BAU tab should not be updated with
    actual GHG emissions values in future years. The purpose of the BAU is to show
    emissions if no strategies were to be implemented. Using actual GHG values in
    future years when several strategies have been implemented would misrepresent
    BAU emissions and may double count savings. Actual emissions from future GHG inventories
    can be entered into the Progress Tracker tab so Longmont can monitor if actual
    GHG emissions align with expected reductions due to strategy implementation.</ul>
    <ul>LPC electricity emission factor updates. Future emission factors from LPC
    should not be added to this tool as the emission factors will reflect the renewable
    energy strategy modeled in this tool. The BAU LPC emission factor represents the
    emission factor if LPC were to not pursue renewable energy. The renewable energy
    EF is used directly in the modeled strategies and should not be adjusted with
    actual values to preserve the desired progress toward RE modeled in this tool.
    Actual progress towards the renewable energy goal will be tracked in each of Longmont''s
    future GHG inventories. Inventory results can be compared to the modeled values
    in the Progress Tracker tab.</ul> <ul>Minor changes in emission calculation methodology.
    Baseline year emissions in the BAU should not be updated when minor methodology
    changes in calculation occur. If methodology changes would not impact total emissions
    in the baseline by greater than 5% then emissions should not be updated for the
    baseline year.</ul></li> The model should be updated for the following reasons
    <li> <ul>Changes to strategy targets or assumptions. If the target for a strategy
    is updated, the target should be updated in the Model Inputs tab and any calculation
    adjustments be made in the corresponding model tab. If more accurate and defensible
    assumptions can be made for a strategy compared to current assumption, assumptions
    should be updated in the Model Inputs tab.</ul> <ul>Xcel electricity emission
    factor updates. Xcel provides a small portion of electricity to Longmont and is
    not a part of LPC''s goal for 100% renewable energy which is modeled in this tool.
    As such, Xcel''s emission factors should be updated either each year or whenever
    new GHG inventory data is available for input in the Progress Tracker tab. This
    ensures that factors outside of the modeled strategies control are as accurate
    as possible.</ul> <ul>Updates to model parameter data (e.g., population and registered
    vehicles). Model parameter data includes model inputs that are NOT impacted by
    strategies. This includes population and registered vehicle data. As no strategies
    currently modeled have an impact on these parameters, they should be updated when
    possible to ensure modeling is using the most up to date external information
    for calculating emissions and emissions reductions. For example, if population
    were to increase more than is currently forecasted in a future year and this number
    were to not be updated, then emissions in the BAU would be nderestimated as the
    BAU uses population increase as a major parameter for forecasting.</ul> <ul>Major
    changes to emission calculation methodology. Major changes to emission calculation
    methodology may warrant updates to the baseline years. Changes that would drastically
    impact emission numbers and make accurate comparison to previous year''s inventory
    data inaccurate would require updating the baseline years to ensure alignment
    across years. For example, the 2016 baseline year emissions were updated as new
    Global Warming Potential values were released by the IPCC. If emissions in future
    years in the BAU or in modeled strategies were calculated with the updated GWPs
    while the baseline year used old GWPs, emissions calculations would not have an
    accurate baseline comparison. Major changes like GWP updates will likely be infrequent.</ul>
    </li> <h2>When to Update Data</h2> <li> <ul><b>Strategy targets.</b> Update if
    strategy targets are adjusted or if new strategies are added.</ul> <ul><b>Actual
    emissions.</b> Update when new GHG emissions inventory data is available.</ul>
    <ul><b>Strategy Selector.</b> Only update if new strategies are added.</ul> <ul><b>Model
    Input Values.</b> Update to reflect any changes in assumptions or strategy targets.</ul>
    <ul><b>Target reduction.</b> Update to reflect any changes in assumptions or strategy
    targets.</ul> <ul><b>Target year.</b> Update to reflect any changes in strategy
    target years.</ul> <ul><b>Business As Usual Baseline emissions.</b> Baseline emissions
    (2016 or 2018) should only be updated if there are major changes to emission calculation
    methodology in future years that would detrimentally impact the models ability
    to compare future emissions to the baseline. Actual GHG emission data for future
    years should NOT be entered into this tab.</ul> <ul><b>Non-electricity emission
    factors.</b> Non-electricity emission factors likely will not change often. It
    is recommended to review emission factor values for updates every few years.</ul>
    <ul><b>Population.</b> Update population data as actual data becomes available.</ul>
    <ul><b>Xcel Energy electricity emission factor.</b> Updated Xcel''s emission factor
    as actual data becomes available.</ul> <ul><b>LPC RE and BAU emission factors.</b>
    Do not update.</ul> <ul><b>Fuel efficiencies.</b> Only update the "Gasoline Passenger
    Vehicle Projected fuel efficiency" row if new fuel efficiency standards are released.</ul>
    <ul><b>Registered vehicles.</b> Update registered vehicle data as actual data
    becomes available.</ul> </li>

scenarios:
- id: baseline
  name: Business as Usual
  params:
  - id: energy_use_intensity_trend.enabled
    value: true
  - id: mpg_trend.enabled
    value: true
  - id: vmt_per_vehicle_trend.enabled
    value: true
  - id: electric_vehicle_efficiency_trend.enabled
    value: true

- id: default
  default: true
  name: Climate Action Initiatives
  all_actions_enabled: true
